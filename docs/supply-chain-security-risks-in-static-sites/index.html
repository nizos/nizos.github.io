<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="/assets/css/main.css" rel="stylesheet" />

        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">

        
        
        
            <meta name="description" content="Static sites are perceived as more secure than their dynamic counterparts due to their simplicity and lack of server-side components. However, this perception can lead to overlooked threats, particularly those introduced by third-party libraries and services. In this article, we&#39;ll explore how these vulnerabilities arise and how you can defend your site against them.">
            <meta property="og:description" content="Static sites are perceived as more secure than their dynamic counterparts due to their simplicity and lack of server-side components. However, this perception can lead to overlooked threats, particularly those introduced by third-party libraries and services. In this article, we&#39;ll explore how these vulnerabilities arise and how you can defend your site against them.">
            <meta name="description" content="Static sites are perceived as more secure than their dynamic counterparts due to their simplicity and lack of server-side components. However, this perception can lead to overlooked threats, particularly those introduced by third-party libraries and services. In this article, we&#39;ll explore how these vulnerabilities arise and how you can defend your site against them."/>
        

        
        
            <meta property="og:image" content="/assets/images/shipping-containers-social-image.jpg"/>
            <meta name="twitter:image" content="/assets/images/shipping-containers-social-image.jpg"/>
        

        <title>
            
                Supply Chain Security Risks in Static Sites | Nizar&#39;s Blog
            
        </title>

        <meta property="og:site_name" content="Nizar's Blog">
        <meta property="og:type" content="website">
        <script defer data-domain="nizar.se" src="https://plausible.io/js/script.js"></script>
    </head>
    <body>
        <div class="layout-wrapper">
            <header class="header">
    <div class="header__content">
        <h1 class="site-title">
            <a href="/">Nizar's Blog</a>
        </h1>
        <nav class="nav">
            <ul class="nav__list">
                <li class="nav-item">
                    <a href="/about">About</a>
                </li>
            </ul>
        </nav>
    </div>
</header>
            <main class="main">
                <article class="post">
    <header class="post__header">
        <h1>Supply Chain Security Risks in Static Sites</h1>
        <div class="post__details">
            <time>11 Sep 2024</time>
            <span> | </span>
            <span>5 minutes</span>
        </div>
    </header>

    <div class="post__cover">
        <picture><source type="image/avif" srcset="/supply-chain-security-risks-in-static-sites/oQnxLjt2WV-300.avif 300w, /supply-chain-security-risks-in-static-sites/oQnxLjt2WV-600.avif 600w, /supply-chain-security-risks-in-static-sites/oQnxLjt2WV-750.avif 750w, /supply-chain-security-risks-in-static-sites/oQnxLjt2WV-900.avif 900w, /supply-chain-security-risks-in-static-sites/oQnxLjt2WV-1200.avif 1200w, /supply-chain-security-risks-in-static-sites/oQnxLjt2WV-1400.avif 1400w" sizes="Cover image"><source type="image/jpeg" srcset="/supply-chain-security-risks-in-static-sites/oQnxLjt2WV-300.jpeg 300w, /supply-chain-security-risks-in-static-sites/oQnxLjt2WV-600.jpeg 600w, /supply-chain-security-risks-in-static-sites/oQnxLjt2WV-750.jpeg 750w, /supply-chain-security-risks-in-static-sites/oQnxLjt2WV-900.jpeg 900w, /supply-chain-security-risks-in-static-sites/oQnxLjt2WV-1200.jpeg 1200w, /supply-chain-security-risks-in-static-sites/oQnxLjt2WV-1400.jpeg 1400w" sizes="Cover image"><img alt="Cover image" loading="lazy" decoding="async" src="/supply-chain-security-risks-in-static-sites/oQnxLjt2WV-300.jpeg" width="1400" height="787"></picture>
        <p class="post__cover-caption">Original photo by <a href="https://unsplash.com/@ventiviews">Venti Views</a> on <a href="https://unsplash.com/photos/aerial-view-of-city-buildings-during-daytime-6p0JBES_65E">Unsplash</a></p>
    </div>

    <main class="post__content">
        <p>Static sites are perceived as more secure than their dynamic counterparts due to their simplicity and lack of
server-side components. However, this perception can lead to overlooked threats, particularly those introduced by
third-party libraries and services. In this article, we'll explore how these vulnerabilities arise and how you can
defend your site against them.</p>
<h2>What Are Static Sites?</h2>
<p>Static sites consist of pre-rendered HTML, CSS, and JavaScript files that are delivered directly to the user's
browser. Their appeal lies in their speed, scalability, and cost-effectiveness. By avoiding server-side processing,
static sites improve performance and reduce resource consumption.</p>
<p>However, many static sites rely on third-party JavaScript libraries or external services for added functionality, such
as form handling or analytics. This introduces supply chain vulnerabilities, where compromised dependencies become
attack vectors.</p>
<h2>The Threat of Supply Chain Attacks</h2>
<p>Supply chain attacks occur when third-party code that your site relies on is compromised. One notorious example is the
<a href="https://sansec.io/research/polyfill-supply-chain-attack">Polyfill.io attack</a>, where malicious code affected over
100,000 websites. The code redirected users to a sports betting site while evading detection:</p>
<blockquote>
<p>The code has specific protection against reverse engineering, and only activates on specific mobile devices at
specific hours. It also does not activate when it detects an admin user. It also delays execution when a web analytics
service is found, presumably to not end up in the stats.</p>
</blockquote>
<p>In another incident, Cloudflare's CDNJS service exposed up to <a href="https://www.bleepingcomputer.com/news/security/critical-cloudflare-cdn-flaw-allowed-compromise-of-12-percent-of-all-sites/">12% of all websites</a>
on the internet to potential code injection attacks, showing that even well-regarded Content Delivery Networks (CDNs) can be vulnerable.</p>
<h2>Defending Against Supply Chain Attacks</h2>
<p>Key defenses against supply chain attacks include <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">Subresource Integrity</a>
(SRI) and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">Content Security Policy</a> (CSP). These tools work best
when used together as part of a layered security approach.</p>
<h3>Subresource Integrity (SRI)</h3>
<p>Subresource Integrity (SRI) ensures that fetched resources, such as JavaScript files, haven't been tampered with. It
does so by comparing the resource's cryptographic hash to a predefined value. If there's a mismatch, the browser blocks
the resource from loading, preventing potential malicious code from executing.</p>
<p>For example:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.example.com/script.js<span class="token punctuation">"</span></span> <span class="token attr-name">integrity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sha384-abc123...<span class="token punctuation">"</span></span> <span class="token attr-name">crossorigin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>anonymous<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre>
<p>In this example, the <code>integrity</code> attribute includes the hash of the file. This ensures the resource is unaltered, adding
an extra layer of protection for external scripts your site relies on.</p>
<h3>Content Security Policy (CSP)</h3>
<p>Content Security Policy (CSP) allows you to define which sources are permitted to load resources such as scripts,
styles, and images. This reduces the risk of code injection by blocking unauthorized content from running on your site.</p>
<p>Here is an example of a CSP that restricts script loading to the same domain and a trusted CDN:</p>
<pre class="language-text"><code class="language-text">Content-Security-Policy: script-src 'self' https://cdn.example.com; style-src 'self';</code></pre>
<p>You can further strengthen your policy with hash-based CSP directives, allowing only scripts with matching cryptographic
hashes to execute, regardless of their source:</p>
<pre class="language-text"><code class="language-text">Content-Security-Policy: script-src 'sha384-abc123...' 'sha384-def456...';</code></pre>
<p>This approach ensures that unauthorized scripts won't run even if the source is compromised.</p>
<h3>Addressing Security Threats</h3>
<p>Using both CSP and SRI together enhances security, as CSP controls where resources can be loaded from while SRI verifies
their integrity. According to the <a href="https://cheatsheetseries.owasp.org/cheatsheets/Content_Security_Policy_Cheat_Sheet.html#defense-in-depth">OWASP CSP Cheat Sheet</a>:</p>
<blockquote>
<p>Even on a fully static website, which does not accept any user input, a CSP can be used to enforce the use of
Subresource Integrity (SRI). This can help prevent malicious code from being loaded on the website if one of the
third-party sites hosting JavaScript files (such as analytics scripts) is compromised.</p>
</blockquote>
<p>These tools help mitigate common security threats:</p>
<ul>
<li><strong>Cross-Site Scripting (XSS)</strong>: XSS attacks allow malicious scripts to be injected into your site, potentially leading
to data theft, session hijacking, or unauthorized actions. CSP blocks unauthorized scripts by restricting which can
run.</li>
<li><strong>Clickjacking</strong>: This attack deceives users into interacting with hidden elements, often resulting in unintended
actions like form submissions or transactions. CSP can prevent clickjacking by blocking your site from being embedded
in iframes, a common method used in such attacks.</li>
<li><strong>Site Defacement</strong>: Attackers may try to alter content on your website, damaging its credibility. A combination of
CSP and SRI ensures that only authorized content is loaded, significantly reducing the risk of defacement.</li>
</ul>
<h3>Best Practices for CSP Implementation</h3>
<p>Despite CSP's effectiveness, it remains underutilized. A <a href="https://www.rapid7.com/blog/post/2020/11/02/overview-of-content-security-policies-csp-on-the-web/">2020 survey</a>
of the Alexa Top 1 Million websites found that only 7% had a valid CSP, and a <a href="https://www.bitsight.com/blog/content-security-policy-limits-dangerous-activity-so-why-isnt-everyone-doing-it">Bitsight study</a>
revealed only 2% of 5 web applications were fully secure.</p>
<p>To fully leverage CSP, follow these best practices:</p>
<ul>
<li><strong>Use a strict default policy</strong>: Start with <code>default-src 'none'</code> and then explicitly allow trusted sources.</li>
<li><strong>Apply restrictions to all sources</strong>: Use <code>style-src</code>, <code>media-src</code>, and other directives to tightly control which
external resources are loaded.</li>
<li><strong>Avoid unsafe directives</strong>: Directives like <code>unsafe-inline</code> and <code>unsafe-eval</code> can undermine your policy by allowing
inline scripts and styles.</li>
<li><strong>Prevent clickjacking</strong>: Use <code>frame-ancestors</code> to block other sites from embedding your content in iframes.</li>
<li><strong>Test with reporting</strong>: Before enforcing CSP, use <code>report-only</code> mode to monitor violations without disrupting
functionality.</li>
</ul>
<h2>Automating Security Practices</h2>
<p>Managing CSP manually can be error-prone, so automation tools are invaluable for maintaining consistent enforcement
without burdening your workflow. At <a href="https://www.factor10.com/">factor10</a>, we automate several processes to reduce human
error while ensuring flexibility for quick interventions:</p>
<ol>
<li><strong>Controlled Script Updates</strong>: During our build process, a utility fetches the latest versions of third-party
scripts, but changes are only introduced after a manual diff-check, giving us full control over updates.</li>
<li><strong>Automated SRI Generation</strong>: Hashes for all fetched scripts are automatically calculated and embedded
into the HTML, ensuring integrity.</li>
<li><strong>Automated Security Headers</strong>: CSP rules are generated and applied to our NGINX configuration during deployment.
If any verification fails, the deployment is discarded, maintaining the security of the live site.</li>
</ol>
<p>By automating these steps and pairing them with monitoring tools, we ensure consistent security practices. Alerts notify
our team of any deviations, allowing us to maintain control and respond promptly.</p>
<h2>Tools for Automating and Testing Security</h2>
<p>The following tools can help you automate security practices and assess or improve your site's security posture:</p>
<ul>
<li><a href="https://csp-evaluator.withgoogle.com/">Googleâ€™s CSP Evaluator</a>: Analyzes your CSP and offers suggestions for
strengthening it.</li>
<li><a href="https://observatory.mozilla.org/">Mozilla Observatory</a>: Provides insights into security headers and suggests
improvements.</li>
<li><a href="https://securityheaders.com/">securityheaders.com</a>: Tests and rates your site's HTTP headers based on best practices.</li>
<li><a href="https://playwright.dev/">Playwright</a>: A versatile tool for cross-browser testing to ensure consistent security
behavior.</li>
<li><a href="http://webperf.se">Webperf.se</a>: Offers an <a href="https://github.com/Webperf-se/webperf_core">open-source suite</a> for
analyzing performance, accessibility, and security.</li>
</ul>
<p>For our <a href="https://factor10.com/websites/">sustainable-websites</a>, we use <a href="https://webperf.se/erbjudande/">webperf's premium service</a>
for daily tests, alongside automated alerts via <a href="https://webperf.se/articles/webhooks/">webhooks</a> on Slack to notify us
of any issues.</p>
<h2>Conclusion</h2>
<p>While static websites are simpler than dynamic ones, they are not immune to modern supply chain threats. The Polyfill.io
incident serves as a reminder that even static sites can be compromised by third-party dependencies. Implementing
security measures like Subresource Integrity (SRI) and Content Security Policy (CSP), combined with automation,
significantly reduces your site's exposure to supply chain risks.</p>
<p>However, no defense strategy is complete without regular testing and monitoring. Vigilance, combined with automation,
ensures that your site remains resilient in the face of evolving threats without sacrificing performance or efficiency.</p>

    </main>

    <aside class="post__aside">
        <div class="post__tags">
            
            
                
                <a href="/tags/web/">#web</a>
            
                
                <a href="/tags/security/">#security</a>
            
        </div>
    </aside>
</article>

            </main>

            <footer class="footer">
    <div class="footer__content">
        <p class="footer__attribution">Powered by <a href="https://www.11ty.dev">11ty</a>, based on <a href="https://github.com/yinkakun/eleventy-duo">Eleventy Duo</a></p>
    </div>
</footer>
        </div>
    </body>
</html>